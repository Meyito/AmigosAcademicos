<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Para la correcta visualización de este sitio, mantener las 3 etiquetas meta en la parte superior, y todas las demas justo despues de este comentario -->
    <title>Amigos Académicos</title>

    <!-- Hojas de estilos -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/styles.css" rel="stylesheet" >
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.10/css/dataTables.bootstrap.min.css">
    <!-- Las siguientes lineas garantizan el funcionamiento de este sitio en versiones antiguas de Internet Explorer -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

  </head>
  <body>
    <!--Navbar logueado-->
    <nav class="navbar navbar-default navbar-fixed-top" id="navbar">
      <div class="container">
        <div class="row">
          <div class="col-xs-12 col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3">
            <a class="navbar-brand" href="index.php">
              <img src="img/logo.png" alt="Amigos Académicos">
            </a>
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#sidebar" aria-expanded="false" >
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>

            <h1 class="text-center">Amigos Académicos</h1>

          </div>
        </div>       
      </div>
    </nav>
    <div class="container-fluid front" id="front">
        <div class="row">
          <div class="col-lg-2 col-md-3 col-sm-3 sidebar collapse navbar-collapse" id="sidebar">
            <a href="index.php" class="wh">
              <div class="row">
                <div class="col-md-4 col-sm-4 col-sm-offset-4 col-md-offset-0 hidden-xs">
                  <img src="img/avatars/h1.png" alt="avatar" class="img-responsive avatar">
                </div>
                <div class="col-md-8 col-sm-12 text-center">
                  <h4>Nombre Apellido</h4>
                  <h5>Administrador</h5>
                </div>
              </div>
            </a>
              <div class="row text-center">
                <a href="#" class="wh" data-toggle="tooltip" title="Cambiar el avatar">
                  <div class="col-xs-4 button-help-sidebar">
                    <span class="glyphicon glyphicon-camera" aria-hidden="true"></span>
                  </div>
                </a>
                <a href="#" class="wh" data-toggle="tooltip" title="Ayuda">
                  <div class="col-xs-4 button-help-sidebar">
                    <span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span>
                  </div>
                </a>
                <a href="#" class="wh" data-toggle="tooltip" title="Cerrar sesión">
                  <div class="col-xs-4 button-help-sidebar">
                    <span class="glyphicon glyphicon-off" aria-hidden="true"></span>
                  </div>
                </a>
              </div>
              <a href="#" class="button-sidebar">
                <div class="row item-sidebar">
                  <div class="col-xs-3 col-sm-2 col-md-2 col-lg-4">
                    <span class="glyphicon glyphicon-stats"></span>
                  </div>
                  <div class="col-xs-9 col-sm-10 col-md-9 col-lg-8">Nombre del item</div>
                </div>
              </a>
              <a href="#" class="button-sidebar">
                <div class="row item-sidebar">
                  <div class="col-xs-3 col-sm-2 col-md-2 col-lg-4">
                    <span class="glyphicon glyphicon-stats"></span>
                  </div>
                  <div class="col-xs-9 col-sm-10 col-md-9 col-lg-8">Nombre del item</div>
                </div>
              </a>
              <a href="#" class="button-sidebar">
                <div class="row item-sidebar">
                  <div class="col-xs-3 col-sm-2 col-md-2 col-lg-4">
                    <span class="glyphicon glyphicon-stats"></span>
                  </div>
                  <div class="col-xs-9 col-sm-10 col-md-9 col-lg-8">Nombre del item</div>
                </div>
              </a>
          </div>
          <div class="col-lg-10 col-md-9 col-sm-9 text-center">
             <h3>Historicos</h3>
             <div class="panel panel-default center-block center-text">
              <div class="panel-heading">
                <h3 class="panel-title">Asesorias por materias</h3>
              </div>
              <div class="panel-body">
                <div class="row">
                  <div class="col-md-10 col-md-offset-1">
                    <div id="HistoricaMaterias"></div>
                  </div>
                  
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-md-6">
                <div class="panel panel-default center-block center-text">
                  <div class="panel-heading">
                    <h3 class="panel-title">Comparativa periodo Previo II</h3>
                  </div>
                  <div class="panel-body">
                    <div class="row">
                      <div class="col-md-10 col-md-offset-1">
                        <div id="HistoricaCursosI"></div>
                      </div>
                      
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="panel panel-default center-block center-text">
                  <div class="panel-heading">
                    <h3 class="panel-title">Comparativa periodo Previo I</h3>
                  </div>
                  <div class="panel-body">
                    <div class="row">
                      <div class="col-md-10 col-md-offset-1">
                        <div id="HistoricaCursosII"></div>
                      </div>
                      
                    </div>
                  </div>
                </div>
              </div>
                <div class="panel panel-default center-block center-text">
                  <div class="panel-heading">
                    <h3 class="panel-title">Comparativa periodo Previo I</h3>
                  </div>
                  <div class="panel-body">
                    <div class="row">
                      <div class="col-md-10 col-md-offset-1">
                        <div id="HistoricaComparativa">
                          <table class="table table-striped" id="comparativa">
                            
                          </table>
                        </div>
                      </div>
                      
                    </div>
                  </div>
                </div>
            </div>
            
            
          </div>
        </div>
    </div>
    <footer id="footer">
       <div class="container">
        <div class="col-sm-3 col-xs-6 text-center">
            <img src="img/ufps_logo.jpg" class="img-responsive" alt="UFPS">
        </div>
        <div class="col-sm-3 col-xs-6 hidden-md hidden-sm hidden-lg text-center">
            <img src="img/ingsistemas_logo.png" class="img-responsive" alt="Ing. Sistemas UFPS">
        </div>
        <div class="col-sm-6 col-xs-12 text-center">
          <p>Universidad Francisco de Paula Santander</p>
          <p>Melissa Delgado - Daniel Vega - Gerson Lázaro</p>
          <p>2015</p>
        </div>
         <div class="col-sm-3 col-xs-6 hidden-xs text-center">
          <img src="img/ingsistemas_logo.png" class="img-responsive" alt="Ing. Sistemas UFPS">
        </div>
      </div>
    </footer>
    <!-- Librerias para el funcionamiento-->
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/index.js"></script>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script src="https://cdn.datatables.net/1.10.10/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.10/js/dataTables.bootstrap.min.js"></script>
    <script type="text/javascript">
       $(function () {
        $('[data-toggle="tooltip"]').tooltip()
      })
      sidebarAdjust();

    //COMUNES
    google.load('visualization', '1', {'packages':['corechart']});

    function obtenerJSONDataAsync(string, callbackOrigin){
      function fetchJSONFile(path, callbackOrigin, callback) {
            var httpRequest = new XMLHttpRequest();
            httpRequest.onreadystatechange = function() {
                if (httpRequest.readyState === 4) {
                    if (httpRequest.status === 200) {
                        var data = httpRequest.responseText;
                        if (callback) callback(data);
                    }
                }
            };
          httpRequest.open('GET', path);
          httpRequest.send(); 
      }
      fetchJSONFile("getData.php?"+string, callbackOrigin, function(data){
          callbackOrigin(data);
      });

    }


    //HISTORICO POR MATERIAS
    google.setOnLoadCallback(drawHistoricaMateriasDecorator);
    function drawHistoricaMateriasDecorator(){
      obtenerJSONDataAsync("peticion=HistoricaMaterias", drawHistoricaMaterias);
    }
    function drawHistoricaMaterias(jsonData) {
      var data = new google.visualization.DataTable(jsonData);
      var chart = new google.visualization.BarChart(document.getElementById('HistoricaMaterias'));
      var options = {
        height: 300
      };
      chart.draw(data, options);
      sidebarAdjust();
    }



    //HISTORICO PERIODO PREVIO I
    google.setOnLoadCallback(drawPeriodoPrevioIDecorator);
    function drawPeriodoPrevioIDecorator(){
      obtenerJSONDataAsync("peticion=periodoPrevioI", drawPeriodoPrevioI);
    }
    function drawPeriodoPrevioI(jsonData) {
      var data = new google.visualization.DataTable(jsonData);
      var chart = new google.visualization.ColumnChart(document.getElementById('HistoricaCursosI'));
      var options = {
        height: 300,
        legend: { position: "none" },
        hAxis: {
          title: 'Cursos'
        },
        vAxis: {
          title: 'Estudiantes'
        }
      };
      chart.draw(data, options);
      sidebarAdjust();
    }

    //HISTORICO PERIODO PREVIO II
    google.setOnLoadCallback(drawPeriodoPrevioIIDecorator);
    function drawPeriodoPrevioIIDecorator(){
      obtenerJSONDataAsync("peticion=periodoPrevioII", drawPeriodoPrevioII);
    }
    function drawPeriodoPrevioII(jsonData) {
      var data = new google.visualization.DataTable(jsonData);
      var chart = new google.visualization.ColumnChart(document.getElementById('HistoricaCursosII'));
      var options = {
        height: 300,
        legend: { position: "none" },
        hAxis: {
          title: 'Cursos'
        },
        vAxis: {
          title: 'Estudiantes'
        }
      };
      chart.draw(data, options);
      sidebarAdjust();
    }


var glob;
    //Comparativa
    function comparativaDecorator(){
      obtenerJSONDataAsync("peticion=comparativa", comparativa);
    }
    comparativaDecorator();
    function comparativa(data){
      jsonData = JSON.parse(data);
      glob = jsonData;
      var build = "";
      var comp = document.getElementById("comparativa");
      build += "<thead><tr><td>Semestre</td><td>"+jsonData["Periodo1"].nombre+"</td><td>"+jsonData["Periodo2"].nombre+"</td></tr></thead><tbody>";
      build += "<tr><td>Promedio de Calificación:</td><td>"+jsonData["Periodo1"].calificacion+"</td><td>"+jsonData["Periodo2"].calificacion+"</td></tr>";
      build += "<tr><td>Total de asistentes a Amigos Académicos:</td><td>"+jsonData["Periodo1"].asistentes+"</td><td>"+jsonData["Periodo2"].asistentes+"</td></tr>";
      build += "<tr><td>Total de estudiantes:</td><td>"+jsonData["Periodo1"].estudiantes+"</td><td>"+jsonData["Periodo2"].estudiantes+"</td></tr>";
      build += "<tr><td>Procentaje asistentes/estudiantes:</td><td>"+jsonData["Periodo1"].porcentaje+"</td><td>"+jsonData["Periodo2"].porcentaje+"</td></tr></tbody>";
      comp.innerHTML = build;
    }
    </script>
  </body>
</html>